<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acesso UniEventos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); height: 100vh; display: flex; align-items: center; justify-content: center; }
        .card-custom { width: 100%; max-width: 400px; border-radius: 15px; border: none; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        .nav-pills .nav-link { color: #555; }
        .nav-pills .nav-link.active { background-color: #1e3c72; color: white; }
    </style>
</head>
<body>
    <div class="card card-custom bg-white p-4">
        <h3 class="text-center mb-4 text-primary fw-bold">UniEventos</h3>
        
        <ul class="nav nav-pills nav-fill mb-3" id="pills-tab" role="tablist">
            <li class="nav-item">
                <button class="nav-link active" id="pills-login-tab" data-bs-toggle="pill" data-bs-target="#pills-login">Login</button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="pills-register-tab" data-bs-toggle="pill" data-bs-target="#pills-register">Cadastro</button>
            </li>
        </ul>
        
        <div class="tab-content">
            <div class="tab-pane fade show active" id="pills-login">
                <form onsubmit="fazerLogin(event)">
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="loginUser" placeholder="Usu치rio" required>
                        <label>Usu치rio</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="password" class="form-control" id="loginPass" placeholder="Senha" required>
                        <label>Senha</label>
                    </div>
                    <button type="submit" class="btn btn-primary w-100 py-2">Entrar</button>
                </form>
            </div>
            
            <div class="tab-pane fade" id="pills-register">
                <form onsubmit="fazerCadastro(event)">
                    <div class="form-floating mb-2">
                        <input type="text" class="form-control" id="regNome" placeholder="Nome Completo" required>
                        <label>Nome Completo</label>
                    </div>
                    <div class="form-floating mb-2">
                        <input type="text" class="form-control" id="regCpf" placeholder="CPF" required>
                        <label>CPF</label>
                    </div>
                    <div class="form-floating mb-2">
                        <input type="text" class="form-control" id="regUser" placeholder="Usu치rio" required>
                        <label>Usu치rio (Login)</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="password" class="form-control" id="regPass" placeholder="Senha" required>
                        <label>Senha</label>
                    </div>
                    <button type="submit" class="btn btn-success w-100 py-2">Cadastrar</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        async function fazerLogin(e) {
            e.preventDefault();
            const res = await fetch('/api/login', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    username: document.getElementById('loginUser').value,
                    password: document.getElementById('loginPass').value
                })
            });
            if(res.ok) window.location.reload();
            else alert("Erro no login");
        }

        async function fazerCadastro(e) {
            e.preventDefault();
            const res = await fetch('/api/registrar', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    nome: document.getElementById('regNome').value,
                    cpf: document.getElementById('regCpf').value,
                    username: document.getElementById('regUser').value,
                    password: document.getElementById('regPass').value
                })
            });
            const json = await res.json();
            alert(json.mensagem || json.erro);
            if(res.ok) window.location.reload();
        }
    </script>
</body>
</html>